<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>L'Art de la Sculpture Malgache</title>
<style>
:root{--accent:#8B5E3C;--bg:#fbf8f5;--muted:#666;--card:#fff}
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:Arial,Helvetica,sans-serif;background:var(--bg);color:#222}
.header{display:flex;align-items:center;justify-content:space-between;padding:14px 18px;background:var(--accent);color:#fff;flex-wrap:wrap}
.brand{font-weight:800;font-size:1.2em}
.nav{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
.nav button{background:transparent;border:1px solid rgba(255,255,255,0.12);color:#fff;padding:6px 12px;border-radius:999px;cursor:pointer;transition:0.2s}
.nav button:hover{background:rgba(255,255,255,0.15)}
.container{max-width:1100px;margin:18px auto;padding:0 16px}
.section{margin-top:18px;padding:14px;background:var(--card);border-radius:10px;box-shadow:0 6px 18px rgba(0,0,0,0.04)}
.section h2{color:var(--accent);margin-bottom:10px}
.hero{display:flex;gap:20px;align-items:center;flex-wrap:wrap}
.hero .left{flex:1}
.thumb{width:320px;border-radius:10px;overflow:hidden;flex-shrink:0}
.thumb img{width:100%;height:100%;object-fit:cover;cursor:pointer;transition:0.2s}
.thumb img:hover{transform:scale(1.03)}
.services-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:14px}
.service-card{background:#fff;padding:14px;border-radius:10px;box-shadow:0 6px 18px rgba(0,0,0,0.04)}
.gallery{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:12px}
.gallery .item{position:relative;border-radius:8px;overflow:hidden;background:#eee;padding-bottom:6px}
.gallery img{width:100%;height:140px;object-fit:cover;display:block;cursor:pointer;transition:transform .18s}
.gallery img:hover{transform:scale(1.04)}
.caption{padding:8px;font-size:13px}
.title{font-weight:700;color:#222}
.desc{color:var(--muted);font-size:13px;margin-top:4px}
.price{color:var(--accent);font-weight:800;margin-top:6px}
.footer{padding:20px;text-align:center;color:var(--muted)}
.lightbox{position:fixed;inset:0;background:rgba(0,0,0,0.85);display:none;align-items:center;justify-content:center;z-index:9999;padding:20px}
.lightbox .box{background:#fff;padding:12px;border-radius:10px;max-width:900px;width:100%;display:flex;gap:12px;align-items:flex-start;flex-wrap:wrap}
.lightbox img{max-width:60%;height:auto;border-radius:8px}
.lightbox .info{max-width:40%}
.input,textarea,input[type=file],select{width:100%;padding:8px;border-radius:6px;border:1px solid #ddd;margin-bottom:8px}
.btn{background:var(--accent);color:#fff;border:0;padding:8px 10px;border-radius:8px;cursor:pointer;transition:0.2s}
.btn:hover{opacity:0.9}
.btn.ghost{background:transparent;color:var(--accent);border:1px solid var(--accent)}
.btn.small{padding:4px 6px;font-size:0.8em}
.admin-toolbar{margin-top:12px;padding:10px;background:#fff8f0;border-radius:8px;border:1px dashed #efd0b3;display:none}
.admin-panel{margin-top:10px;background:#fff8f0;padding:12px;border-radius:10px;display:none}
.login-modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,0.6);z-index:10000}
.login-card{background:#fff;padding:18px;border-radius:12px;width:94%;max-width:420px}
.row{display:flex;gap:8px;flex-wrap:wrap}
.row .col{flex:1;min-width:120px}
.note{color:var(--muted);font-size:13px}
.toast{position:fixed;top:20px;left:50%;transform:translateX(-50%);background:var(--accent);color:#fff;padding:10px 16px;border-radius:6px;opacity:0;pointer-events:none;transition:0.3s;z-index:10001}
@media(max-width:820px){.hero{flex-direction:column}.thumb{width:100%}.lightbox .box{flex-direction:column}.lightbox img{max-width:100%}.lightbox .info{max-width:100%}}
</style>
</head>
<body>

<header class="header">
  <div class="brand">L'Art de la Sculpture Malgache</div>
  <nav class="nav">
    <button onclick="show('accueil')">Accueil</button>
    <button onclick="show('apropos')">À propos</button>
    <button onclick="show('prehistoire')">Pré-histoire</button>
    <button onclick="show('services')">Services</button>
    <button onclick="show('galerie')">Galerie</button>
    <button onclick="show('commande')">Commander</button>
    <button onclick="show('contact')">Contact</button>
    <button onclick="openLogin()">Admin</button>
  </nav>
</header>

<main class="container">
  <!-- Accueil -->
  <section id="accueil" class="section">
    <div class="hero">
      <div class="left">
        <h2 id="heroTitle">Histoire & héritage de la sculpture malgache</h2>
        <p id="heroText">Le sculpteur malgache puise son inspiration dans les traditions ancestrales et les légendes locales. Depuis des siècles, l’art de la sculpture transmet la culture, les croyances et l’âme du peuple.</p>
        <div class="note" id="adminNotice" style="display:none">Admin connecté — outils d'édition visibles</div>
      </div>
      <div class="thumb">
        <img id="heroImg" src="images/madagascar1.jpg" alt="Accueil" onclick="openLightboxFromHero()">
      </div>
    </div>
    <div id="adminAccueil" class="admin-panel">
      <h3>Modifier Accueil</h3>
      <textarea id="editHeroText" rows="4" class="input"></textarea>
      <input type="file" id="editHeroImage" accept="image/*" class="input">
      <div class="row">
        <button class="btn" onclick="saveHero()">Enregistrer</button>
        <button class="btn ghost" onclick="resetHero()">Réinitialiser</button>
      </div>
      <p class="note">Uploader depuis téléphone/ordinateur. Les images sont stockées localement dans le navigateur (localStorage).</p>
    </div>
  </section>

  <!-- À propos -->
  <section id="apropos" class="section" style="display:none">
    <h2>À propos</h2>
    <p id="aboutText">Artisan sculpteur malgache — bois, pierre et matériaux naturels.</p>
    <div id="adminApropos" class="admin-panel">
      <h3>Modifier À propos</h3>
      <textarea id="editAbout" rows="4" class="input"></textarea>
      <button class="btn" onclick="saveAbout()">Enregistrer</button>
    </div>
  </section>

  <!-- Pré-histoire -->
  <section id="prehistoire" class="section" style="display:none">
    <h2>Pré-histoire et Origines</h2>
    <p id="prehistoireText">Les premières sculptures malgaches remontent à des siècles ; elles représentaient ancêtres et esprits. Chaque région a développé un style propre.</p>
    <div id="adminPrehistoire" class="admin-panel">
      <h3>Modifier Pré-histoire</h3>
      <textarea id="editPrehistoire" rows="4" class="input"></textarea>
      <button class="btn" onclick="savePrehistoire()">Enregistrer</button>
    </div>
  </section>

  <!-- Services -->
  <section id="services" class="section" style="display:none">
    <h2>Services</h2>
    <div id="servicesGrid" class="services-grid"></div>
    <div id="adminServices" class="admin-panel">
      <h3>Modifier Services</h3>
      <textarea id="editServices" rows="4" class="input" placeholder="Une ligne = un service"></textarea>
      <button class="btn" onclick="saveServices()">Enregistrer</button>
    </div>
  </section>

  <!-- Galerie -->
  <section id="galerie" class="section" style="display:none">
    <h2>Galerie</h2>
    <div id="galleryGrid" class="gallery"></div>
    <div id="adminGallery" class="admin-panel">
      <h3>Gérer la galerie (titre / description / prix)</h3>
      <input type="file" id="galleryFile" accept="image/*" class="input">
      <input id="galleryTitle" class="input" placeholder="Titre">
      <input id="galleryPrice" class="input" placeholder="Prix">
      <textarea id="galleryDesc" rows="2" class="input" placeholder="Brève description"></textarea>
      <div class="row">
        <button class="btn" onclick="addGalleryItem()">Ajouter</button>
        <button class="btn ghost" onclick="clearGallery()">Vider la galerie</button>
      </div>
      <div id="galleryAdminList" style="margin-top:12px"></div>
      <p class="note">Remplacer une image : utilisez le bouton "Remplacer" à côté de la miniature. Supprimer : bouton "Supprimer".</p>
    </div>
  </section>

  <!-- Commande -->
  <section id="commande" class="section" style="display:none">
    <h2>Commander une œuvre</h2>
    <form id="orderForm">
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px">
        <input type="text" id="orderName" placeholder="Votre nom" required>
        <input type="email" id="orderEmail" placeholder="Votre e-mail" required>
      </div>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px">
        <input type="text" id="orderTel" placeholder="Téléphone">
        <select id="orderType">
          <option value="bois">Bois</option>
          <option value="pierre">Pierre</option>
          <option value="mixte">Mixte</option>
        </select>
      </div>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:8px">
        <select id="orderOeuvre"></select>
        <input type="number" id="orderQty" min="1" value="1">
      </div>
      <textarea id="orderMsg" placeholder="Message / détails" style="margin-top:8px"></textarea>
      <div style="display:flex;gap:8px;margin-top:8px">
        <button class="btn" type="submit">Envoyer la commande</button>
        <button class="btn ghost" type="button" onclick="resetOrderForm()">Annuler</button>
      </div>
    </form>
    <div id="adminOrders" class="admin-panel">
      <h3>Commandes reçues</h3>
      <div id="ordersList"></div>
      <div style="margin-top:8px">
        <button class="btn ghost" onclick="clearOrders()">Vider les commandes</button>
      </div>
    </div>
  </section>

  <!-- Contact -->
  <section id="contact" class="section" style="display:none">
    <h2>Contact</h2>
    <p>Email : <span id="contactEmail">contact@artmalagasy.mg</span></p>
    <p>Téléphone : <span id="contactTel">+261 34 00 000 00</span></p>
    <p>Facebook : <span id="contactFB">facebook.com/natureartisanale</span></p>
    <p>WhatsApp : <span id="contactWA">+261 34 00 000 00</span></p>
    <div id="adminContact" class="admin-panel">
      <h3>Modifier Contact</h3>
      <input id="editContactEmail" class="input" placeholder="Email">
      <input id="editContactTel" class="input" placeholder="Téléphone">
      <input id="editContactFB" class="input" placeholder="Facebook">
      <input id="editContactWA" class="input" placeholder="WhatsApp">
      <button class="btn" onclick="saveContact()">Enregistrer</button>
    </div>
  </section>

  <!-- Admin Settings -->
  <section id="adminSettings" class="section" style="display:none">
    <h2>Administration</h2>
    <div class="admin-panel">
      <h3>Modifier identifiants Admin</h3>
      <div class="row">
        <div class="col"><input id="newAdminEmail" class="input" placeholder="Nouvel email"></div>
        <div class="col"><input id="newAdminPass" class="input" placeholder="Nouveau mot de passe"></div>
      </div>
      <div class="row">
        <button class="btn" onclick="changeAdminCreds()">Enregistrer identifiants</button>
        <button class="btn ghost" onclick="logoutAdmin()">Se déconnecter</button>
      </div>
    </div>
    <div class="admin-panel">
      <h3>Sauvegarder / Restaurer</h3>
      <div class="row">
        <button class="btn" onclick="exportJSON()">Exporter JSON</button>
        <input type="file" id="importFile" class="input">
        <button class="btn ghost" onclick="importJSON()">Importer JSON</button>
      </div>
      <p class="note">Le backup contient tout le contenu (images en base64 si uploadées).</p>
    </div>
  </section>
</main>

<footer class="footer">© <span id="year"></span> L'Art de la Sculpture Malgache — Madagascar</footer>

<div id="lightbox" class="lightbox" onclick="if(event.target.id==='lightbox') closeLightbox()">
  <div class="box">
    <img id="lightboxImg" src="">
    <div class="info">
      <div class="title" id="lightboxTitle"></div>
      <div class="desc" id="lightboxDesc"></div>
      <div class="price" id="lightboxPrice"></div>
      <div style="margin-top:10px"><button class="btn" onclick="closeLightbox()">Fermer</button></div>
    </div>
  </div>
</div>

<div id="loginModal" class="login-modal" onclick="if(event.target.id==='loginModal') closeLogin()">
  <div class="login-card">
    <h3>Connexion Admin</h3>
    <input id="loginEmail" class="input" placeholder="Email">
    <input id="loginPass" class="input" placeholder="Mot de passe" type="password">
    <div class="row">
      <button class="btn" onclick="login()">Se connecter</button>
      <button class="btn ghost" onclick="closeLogin()">Annuler</button>
    </div>
    <p id="loginError" style="color:#b00020"></p>
    <p class="note">Identifiants par défaut : <strong>admin@site.com</strong> / <strong>1234</strong></p>
  </div>
</div>

<div id="toast" class="toast"></div>

<script>
/* -----------------------------
   State & localStorage
   ----------------------------- */
const KEY = 'sculpture_gallery_final_v2';
function defaultState(){
  return {
    creds:{email:'admin@site.com',pass:'1234'},
    hero:{text:`Le sculpteur malgache puise son inspiration dans les traditions ancestrales et les légendes locales. Depuis des siècles, l’art de la sculpture transmet la culture, les croyances et l’âme du peuple.`, image:'images/madagascar1.jpg'},
    about:'Artisan sculpteur malgache — bois, pierre et matériaux naturels.',
    prehistoire:'Les premières sculptures malgaches remontent à des siècles ; elles représentaient ancêtres et esprits.',
    services:['Commandes personnalisées','Restauration d’œuvres','Expositions','Ateliers & Formations'],
    contact:{email:'contact@artmalagasy.mg',tel:'+261 34 00 000 00',fb:'facebook.com/natureartisanale',wa:'+261 34 00 000 00'},
    gallery:[
      {image:'images/madagascar1.jpg', title:'Sculpture Bois 1', desc:'Bois sculpté, finitions naturelles', price:'120 000 MGA'},
      {image:'images/madagascar2.jpg', title:'Sculpture Pierre 1', desc:'Pierre gravée, ton vert', price:'200 000 MGA'},
      {image:'images/madagascar3.jpg', title:'Sculpture Mixte', desc:'Bois et pierre combinés', price:'350 000 MGA'}
    ],
    orders:[]
  };
}
let state = JSON.parse(localStorage.getItem(KEY)) || defaultState();
let currentSection = 'accueil';
let isAdmin = false;

/* -----------------------------
   Toast notification
   ----------------------------- */
function showToast(msg){
  const t=document.getElementById('toast');
  t.textContent=msg;
  t.style.opacity=1;
  setTimeout(()=>t.style.opacity=0,2500);
}

/* -----------------------------
   Section display
   ----------------------------- */
function show(id){
  document.querySelectorAll('main .section').forEach(s=>s.style.display='none');
  const sec=document.getElementById(id);
  if(sec) sec.style.display='block';
  currentSection=id;
}

/* -----------------------------
   Admin login
   ----------------------------- */
function openLogin(){document.getElementById('loginModal').style.display='flex'}
function closeLogin(){document.getElementById('loginModal').style.display='none'}
function login(){
  const e=document.getElementById('loginEmail').value;
  const p=document.getElementById('loginPass').value;
  if(e===state.creds.email && p===state.creds.pass){
    isAdmin=true;
    closeLogin();
    showToast('Admin connecté');
    document.querySelectorAll('.admin-panel').forEach(el=>el.style.display='block');
    document.getElementById('adminNotice').style.display='block';
  }else document.getElementById('loginError').textContent='Email ou mot de passe incorrect';
}
function logoutAdmin(){
  isAdmin=false;
  document.querySelectorAll('.admin-panel').forEach(el=>el.style.display='none');
  document.getElementById('adminNotice').style.display='none';
  showToast('Admin déconnecté');
}

/* -----------------------------
   Hero
   ----------------------------- */
function saveHero(){
  const text=document.getElementById('editHeroText').value;
  const file=document.getElementById('editHeroImage').files[0];
  state.hero.text=text;
  if(file){
    const reader=new FileReader();
    reader.onload=e=>{
      state.hero.image=e.target.result;
      document.getElementById('heroImg').src=state.hero.image;
      localStorage.setItem(KEY,JSON.stringify(state));
      showToast('Accueil mis à jour');
    };
    reader.readAsDataURL(file);
  }else{
    document.getElementById('heroText').textContent=text;
    localStorage.setItem(KEY,JSON.stringify(state));
    showToast('Accueil mis à jour');
  }
  document.getElementById('heroText').textContent=text;
}
function resetHero(){
  document.getElementById('editHeroText').value=state.hero.text;
}

/* -----------------------------
   À propos
   ----------------------------- */
function saveAbout(){
  const val=document.getElementById('editAbout').value;
  state.about=val;
  document.getElementById('aboutText').textContent=val;
  localStorage.setItem(KEY,JSON.stringify(state));
  showToast('À propos mis à jour');
}

/* -----------------------------
   Pré-histoire
   ----------------------------- */
function savePrehistoire(){
  const val=document.getElementById('editPrehistoire').value;
  state.prehistoire=val;
  document.getElementById('prehistoireText').textContent=val;
  localStorage.setItem(KEY,JSON.stringify(state));
  showToast('Pré-histoire mise à jour');
}

/* -----------------------------
   Services
   ----------------------------- */
function saveServices(){
  const val=document.getElementById('editServices').value;
  state.services=val.split('\n').filter(v=>v.trim()!=='');
  renderServices();
  localStorage.setItem(KEY,JSON.stringify(state));
  showToast('Services mis à jour');
}
function renderServices(){
  const grid=document.getElementById('servicesGrid');
  grid.innerHTML='';
  state.services.forEach(s=>{
    const div=document.createElement('div');
    div.className='service-card';
    div.textContent=s;
    grid.appendChild(div);
  });
}
renderServices();

/* -----------------------------
   Galerie
   ----------------------------- */
function renderGallery(){
  const g=document.getElementById('galleryGrid');
  const oeuvres=document.getElementById('orderOeuvre');
  g.innerHTML=''; oeuvres.innerHTML='';
  state.gallery.forEach((item,i)=>{
    const div=document.createElement('div'); div.className='item';
    div.innerHTML=`<img src="${item.image}" alt="${item.title}" onclick="openLightbox(${i})">
                     <div class="caption"><div class="title">${item.title}</div>
                     <div class="desc">${item.desc}</div><div class="price">${item.price}</div></div>`;
    g.appendChild(div);
    const opt=document.createElement('option'); opt.value=i; opt.textContent=item.title; oeuvres.appendChild(opt);
  });
}
renderGallery();

function addGalleryItem(){
  const file=document.getElementById('galleryFile').files[0];
  const title=document.getElementById('galleryTitle').value;
  const desc=document.getElementById('galleryDesc').value;
  const price=document.getElementById('galleryPrice').value;
  if(file && title){
    const reader=new FileReader();
    reader.onload=e=>{
      state.gallery.push({image:e.target.result,title,desc,price});
      localStorage.setItem(KEY,JSON.stringify(state));
      renderGallery();
      showToast('Image ajoutée');
    };
    reader.readAsDataURL(file);
  }else showToast('Titre et image requis');
}
function clearGallery(){state.gallery=[];localStorage.setItem(KEY,JSON.stringify(state));renderGallery();showToast('Galerie vidée');}

/* -----------------------------
   Lightbox
   ----------------------------- */
function openLightbox(i){
  const lb=document.getElementById('lightbox');
  document.getElementById('lightboxImg').src=state.gallery[i].image;
  document.getElementById('lightboxTitle').textContent=state.gallery[i].title;
  document.getElementById('lightboxDesc').textContent=state.gallery[i].desc;
  document.getElementById('lightboxPrice').textContent=state.gallery[i].price;
  lb.style.display='flex';
}
function openLightboxFromHero(){
  showToast('Image de présentation (hero)');
}
function closeLightbox(){document.getElementById('lightbox').style.display='none'}

/* -----------------------------
   Commande
   ----------------------------- */
document.getElementById('orderForm').addEventListener('submit',e=>{
  e.preventDefault();
  const o={name:orderName.value,email:orderEmail.value,tel:orderTel.value,type:orderType.value,oeuvre:orderOeuvre.value,qty:orderQty.value,msg:orderMsg.value};
  state.orders.push(o);
  localStorage.setItem(KEY,JSON.stringify(state));
  showToast('Commande envoyée');
  renderOrders();
  resetOrderForm();
});
function resetOrderForm(){document.getElementById('orderForm').reset();}

/* -----------------------------
   Orders
   ----------------------------- */
function renderOrders(){
  const l=document.getElementById('ordersList');
  l.innerHTML='';
  state.orders.forEach((o,i)=>{
    const div=document.createElement('div');
    div.style.borderBottom='1px dashed #ddd'; div.style.padding='6px 0';
    div.innerHTML=`<strong>${o.name}</strong> (${o.email}) — ${o.oeuvre} x ${o.qty} <button class="btn small ghost" onclick="removeOrder(${i})">Supprimer</button>`;
    l.appendChild(div);
  });
}
function removeOrder(i){state.orders.splice(i,1);localStorage.setItem(KEY,JSON.stringify(state));renderOrders();}
function clearOrders(){state.orders=[];localStorage.setItem(KEY,JSON.stringify(state));renderOrders();showToast('Commandes vidées');}
renderOrders();

/* -----------------------------
   Contact
   ----------------------------- */
function saveContact(){
  state.contact.email=document.getElementById('editContactEmail').value;
  state.contact.tel=document.getElementById('editContactTel').value;
  state.contact.fb=document.getElementById('editContactFB').value;
  state.contact.wa=document.getElementById('editContactWA').value;
  document.getElementById('contactEmail').textContent=state.contact.email;
  document.getElementById('contactTel').textContent=state.contact.tel;
  document.getElementById('contactFB').textContent=state.contact.fb;
  document.getElementById('contactWA').textContent=state.contact.wa;
  localStorage.setItem(KEY,JSON.stringify(state));
  showToast('Contact mis à jour');
}

/* -----------------------------
   Admin creds & JSON
   ----------------------------- */
function changeAdminCreds(){
  const e=document.getElementById('newAdminEmail').value;
  const p=document.getElementById('newAdminPass').value;
  if(e && p){state.creds={email:e,pass:p};localStorage.setItem(KEY,JSON.stringify(state));showToast('Identifiants changés');}
}
function exportJSON(){
  const blob=new Blob([JSON.stringify(state)],{type:'application/json'});
  const a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download='backup.json';a.click();
}
function importJSON(){
  const f=document.getElementById('importFile').files[0];
  if(f){
    const reader=new FileReader();
    reader.onload=e=>{
      try{state=JSON.parse(e.target.result);localStorage.setItem(KEY,JSON.stringify(state));renderServices();renderGallery();renderOrders();showToast('JSON importé');}catch(err){showToast('Erreur import')}}
    reader.readAsText(f);
  }
}

/* -----------------------------
   Footer year
   ----------------------------- */
document.getElementById('year').textContent=new Date().getFullYear();

/* -----------------------------
   Initial fill inputs
   ----------------------------- */
if(isAdmin){
  document.getElementById('editHeroText').value=state.hero.text;
  document.getElementById('editAbout').value=state.about;
  document.getElementById('editPrehistoire').value=state.prehistoire;
  document.getElementById('editServices').value=state.services.join('\n');
  document.getElementById('editContactEmail').value=state.contact.email;
  document.getElementById('editContactTel').value=state.contact.tel;
  document.getElementById('editContactFB').value=state.contact.fb;
  document.getElementById('editContactWA').value=state.contact.wa;
}
</script>
</body>
</html>
